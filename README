##########################################################################
README file for NUPACK 3.2.2
Copyright (c) 2007-2017, California Institute of Technology. 
All Rights Reserved. See LICENSE file.

See NUPACK User Guide in /doc folder for full details.
##########################################################################

##########################################################################
Required Packages
##########################################################################
The following packages must be installed to compile NUPACK3.1.0:

cmake (version 2.6.0+)  - A cross-platform open-source build system.

It can be downloaded from www.cmake.org or installed using a package manager 

##########################################################################
Building and installing NUPACK
##########################################################################
1) To build NUPACK, type the following commands:

mkdir build
cd build
cmake ../
make

2) To install NUPACK, type the following command: 

make install

Note: You will need superuser privileges to run the install command,
as the default installation is to subdirectories of /usr/local/ 


##########################################################################
Preparation before running NUPACK
##########################################################################

1) Run the adscodex encoder as described in the README file. You should get an output file

2) Move the adscodex output file to a directory, ie. ~/temp

3) Rename the adscodex output file (if needed) to have a ".in" suffix. This output file serves as the input file for NUPACK

For example: input file is
    ~/temp/dna.in

4) Build the NUPACK mfes command 

cd nupack3.2.2 && cd build && cmake ../ && make mfes && sudo make install

5) Run the NUPACK mfes command

mfes -material dna -multi prefix 
    where prefix is the prefix of the input file

For example, given the file setup described above, the command would be:
    mfes -material dna -multi ~/temp/dna

The command locates the input file as prefix concatenated with the suffix ".in"
The output of the command is the prefix concatenated with the suffix ".mfes", such as: 
    ~/temp/test1.mfes

6) Check the output

Open the output .mfes file. The first line after the comments should be a decimal number representing the sum of the oligos' MFE (minimum free energy) value. 

7) Verify the output

Run
    head ~/temp/dna.in      (or whereever your input file is)

The first line should be the number of oligos in the dataset. Divide the MFE sum from the output file by the number of oligos from the input file. The result should be around -14.


##########################################################################
Custom builds and installations
##########################################################################
If you wish to compile multiple versions of NUPACK, 
simply make additional build directories (e.g., build2, build3, ...)
using analogous commands as above

Various build configuration options can be passed to cmake. 
For example, to specify different compilers, substitute the command: 

cmake -DCMAKE_C_COMPILER=gcc -DCMAKE_CXX_COMPILER=g++ ../

See www.cmake.org for documentation. 

The install process will put executables in <prefix>/bin, libraries 
in <prefix>/lib include headers in <prefix>/include, and parameters 
in <prefix>/share with default location: <prefix>=/usr/local/
 
To use a different install location:
 
1) substitute the command:

cmake -DCMAKE_INSTALL_PREFIX=<prefix> ../

2) set the NUPACKHOME environment variable: 

export NUPACKHOME=<prefix> 

3) add NUPACKHOME to your path:

export PATH=$PATH:$NUPACKHOME
